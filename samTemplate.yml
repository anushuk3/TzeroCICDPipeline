AWSTemplateFormatVersion: '2010-09-09'
Transform: 'AWS::Serverless-2016-10-31'
Description: 'Telkom Tzero CloudFormation For AWS Resources Cognito,
              DynamoDB, Lambda and API Gateway'
Parameters:
  EnvName:
    Description: Name of an environment. 'dev', 'staging', 'prod' and any name.
    AllowedPattern: ^.*[^0-9]$
    ConstraintDescription: Must end with non numeric character.
    Type: String
    Default: "Test"
# ********** Tzero DynamoDB Parameters -Start **************
  ReadCapacityUnits:
    Description: Provisioned read throughput
    Type: Number
    Default: '1'
    MinValue: '1'
    MaxValue: '10000'
    ConstraintDescription: must be between 5 and 10000
  WriteCapacityUnits:
    Description: Provisioned write throughput
    Type: Number
    Default: '1'
    MinValue: '1'
    MaxValue: '10000'
    ConstraintDescription: must be between 5 and 10000
# ********** Tzero DynamoDB Parameters- End **************

# ********** Tzero Lambda Functions Parameters- Start ************** 
# Lambda Function Target S3 key(CodePath) name
  TzeroRegistrationS3Key:
    Description: s3 key name for the lambda package in s3
    Type: String
    Default: './LambdaCode'    
#Lambda Function Environment Variables
  LambdaTemporaryPassword:
    Type: "String"
    Default: "Test@09876"    
  LambdaConfigurationBucket:
    Type: "String"
    Default: "tzero-telkom-backend-dev"    
  RegistrationConfigPath:
    Type: "String"
    Default: "Config/TzeroConfig.json"    
  CompressedConsumerMediasCloudfrontDomainName:
    Type: "String"
    Default: "db8b0orzamzr7.cloudfront.net"     
  Region:
    Type: "String"
    Default: "eu-west-1"    
  ProducerMarketPlaceFilePath:
    Type: "String"
    Default: "Producer/Media/"    
  ProducerMarketPlaceImageUploadUrlExpiry:
    Type: "Number"
    Default: "900"    
  ProducerMarketPlaceIndustryTagsPath: 
    Type: "String"
    Default: "Config/IndustriesAndTags.json"    
  ProducerMarketPlaceMediaFilesBucket:
    Type: "String"
    Default: "tzero-telkom-backend-dev"    
  ProducerMarketPlaceThumbNailAppend: 
    Type: "String"
    Default: "-thumbnail.jpg"    
  ConsumerReportContentReceiverEmailAddress:
    Type: "String"
    Default: "engg.anuragshukla@gmail.com"    
  ConsumerReportContentReportingThreshold:
    Type: "Number"
    Default: 5    
  ConsumerReportContentSenderEmailAddress:
    Type: "String"
    Default: "tzero@telkom.co.za"    
# ********** Tzero Lambda Functions Parameters- End **************
# ********** Tzero APIGateway Parameters- Start **************
  TzeroRestApiName:
    Description: API gateway name
    Type: String
    Default: 'TzeroRestApi'
  TzeroApiGatewayStageName:
    Type: "String"
    AllowedPattern: "^[a-z0-9]+$"
    Default: "dev"
  TzeroApiDeploymentStageName:
     Type: "String"
     Default: "dev"
# ********** Tzero APIGateway Parameters- End **************
Resources:
# ********** Tzero Cognito "UserPool/ClientID" Resource- Start**************
# TRIGGER NEED TO BE ADDED IN THIS CF 
# Producer pool & AppClient creation
  TzeroProducerUserPool:
    Type: AWS::Cognito::UserPool
    Properties:
      MfaConfiguration: "OFF"
      UserPoolName: !Sub ${EnvName}_TzeroProducerUserPool
      UsernameAttributes:
       - email
      AutoVerifiedAttributes:
       - email
      VerificationMessageTemplate:
        DefaultEmailOption: CONFIRM_WITH_LINK
      EmailVerificationSubject: "Tzero Registration Link"
      EmailVerificationMessage: 'Dear Producer,Welcome to Telkom T-Zero CommunityThank you for Registering as a producer, Complete your registration by clicking the link below to verify your email address.Verify Email{####}  Click here to Login : http://cloudtechnologies.cloud/login Thanks,Team Tzero '
      Schema:
        - Name: name
          AttributeDataType: String
          Mutable: true
          Required: true
        - Name: email
          AttributeDataType: String
          Mutable: false
          Required: true
        - Name: profile
          AttributeDataType: String
          Mutable: false
          Required: true
      Policies:
       PasswordPolicy:
        MinimumLength: 8
        RequireLowercase: True
        RequireNumbers: True
        RequireSymbols: False
        RequireUppercase: True
  TzeroProducerAppClient:
    Type: "AWS::Cognito::UserPoolClient"
    Properties:
     ClientName: !Sub ${EnvName}_TzeroProducerAppClient
     GenerateSecret: False
     UserPoolId:
       Ref: TzeroProducerUserPool       
# Consumer pool & Client creation
  TzeroConsumerUserPool:
    Type: AWS::Cognito::UserPool
    Properties:
      MfaConfiguration: "OFF"
      UserPoolName: !Sub ${EnvName}_TzeroConsumerUserPool
      UsernameAttributes:
       - phone_number
      Schema:
        - Name: name
          AttributeDataType: String
          Mutable: true
          Required: true
        - Name: email
          AttributeDataType: String
          Mutable: false
          Required: true
        - Name: profile
          AttributeDataType: String
          Mutable: false
          Required: true
      Policies:
       PasswordPolicy:
        MinimumLength: 8
        RequireLowercase: True
        RequireNumbers: True
        RequireSymbols: False
        RequireUppercase: True
  TzeroConsumerAppClient:
    Type: "AWS::Cognito::UserPoolClient"
    Properties:
     ClientName: !Sub ${EnvName}_TzeroConsumerAppClient
     GenerateSecret: False
     UserPoolId:
       Ref: TzeroConsumerUserPool
# ********** Tzero Cognito "UserPool/ClientID" Resource- End**************

# ********** DynamoDB Resource creation- Start**************
  TzeroProducerTable:
    Type: AWS::DynamoDB::Table
    Properties:
      KeySchema:
      - AttributeName: producerID
        KeyType: HASH
      AttributeDefinitions:
      - AttributeName: producerID
        AttributeType: S
      TableName: !Sub ${EnvName}_TzeroProducerTable
      ProvisionedThroughput:
        ReadCapacityUnits: !Ref 'ReadCapacityUnits'
        WriteCapacityUnits: !Ref 'WriteCapacityUnits'
  TzeroProducerAdvertTable:
    Type: AWS::DynamoDB::Table
    Properties:
      KeySchema:
      - AttributeName: advertisement_id
        KeyType: HASH
      AttributeDefinitions:
      - AttributeName: advertisement_id
        AttributeType: N
      TableName: !Sub ${EnvName}_TzeroProducerAdvertTable
      ProvisionedThroughput:
        ReadCapacityUnits: !Ref 'ReadCapacityUnits'
        WriteCapacityUnits: !Ref 'WriteCapacityUnits'
  TzeroProducerSupportTicketTable:
    Type: AWS::DynamoDB::Table
    Properties:
      KeySchema:
      - AttributeName: supportTicketID
        KeyType: HASH
      AttributeDefinitions:
      - AttributeName: supportTicketID
        AttributeType: N
      TableName: !Sub ${EnvName}_TzeroProducerSupportTicketTable
      ProvisionedThroughput:
        ReadCapacityUnits: !Ref 'ReadCapacityUnits'
        WriteCapacityUnits: !Ref 'WriteCapacityUnits'  
  TzeroProducerIndustryTagsTable:
    Type: AWS::DynamoDB::Table
    Properties:
      KeySchema:
      - AttributeName: Industry
        KeyType: HASH
      AttributeDefinitions:
      - AttributeName: Industry
        AttributeType: S
      TableName: !Sub ${EnvName}_TzeroProducerIndustryTagsTable
      ProvisionedThroughput:
        ReadCapacityUnits: !Ref 'ReadCapacityUnits'
        WriteCapacityUnits: !Ref 'WriteCapacityUnits'
  TzeroConsumerTable:
    Type: AWS::DynamoDB::Table
    Properties:
      KeySchema:
      - AttributeName: Cognito_Id
        KeyType: HASH
      - AttributeName: Phone_Number
        KeyType: RANGE
      AttributeDefinitions:
      - AttributeName: Cognito_Id
        AttributeType: S
      - AttributeName: Phone_Number
        AttributeType: S
      TableName: !Sub ${EnvName}_TzeroConsumerTable
      ProvisionedThroughput:
        ReadCapacityUnits: !Ref 'ReadCapacityUnits'
        WriteCapacityUnits: !Ref 'WriteCapacityUnits'
  TzeroConsumerTransactionsTable:
    Type: AWS::DynamoDB::Table
    Properties:
      KeySchema:
      - AttributeName: TransactionId
        KeyType: HASH
      - AttributeName: Phone_Number
        KeyType: RANGE
      AttributeDefinitions:
      - AttributeName: TransactionId
        AttributeType: S
      - AttributeName: Phone_Number
        AttributeType: S
      TableName: !Sub ${EnvName}_TzeroConsumerTransactionsTable
      ProvisionedThroughput:
        ReadCapacityUnits: !Ref 'ReadCapacityUnits'
        WriteCapacityUnits: !Ref 'WriteCapacityUnits'
  TzeroConsumerCredentialsTable:
    Type: AWS::DynamoDB::Table
    Properties:
      KeySchema:
      - AttributeName: User_Name
        KeyType: HASH
      AttributeDefinitions:
      - AttributeName: User_Name
        AttributeType: S
      TableName: !Sub ${EnvName}_TzeroConsumerCredentialsTable
      ProvisionedThroughput:
        ReadCapacityUnits: !Ref 'ReadCapacityUnits'
        WriteCapacityUnits: !Ref 'WriteCapacityUnits'
  TzeroConsumerExperiencePointsTable:
    Type: AWS::DynamoDB::Table
    Properties:
      KeySchema:
      - AttributeName: transactionId
        KeyType: HASH
      AttributeDefinitions:
      - AttributeName: transactionId
        AttributeType: N
      TableName: !Sub ${EnvName}_TzeroConsumerExperiencePointsTable
      ProvisionedThroughput:
        ReadCapacityUnits: !Ref 'ReadCapacityUnits'
        WriteCapacityUnits: !Ref 'WriteCapacityUnits'
  TzeroSurveyTable:
    Type: AWS::DynamoDB::Table
    Properties:
      KeySchema:
      - AttributeName: survey_id
        KeyType: HASH
      AttributeDefinitions:
      - AttributeName: survey_id
        AttributeType: N
      TableName: !Sub ${EnvName}_TzeroSurveyTable
      ProvisionedThroughput:
        ReadCapacityUnits: !Ref 'ReadCapacityUnits'
        WriteCapacityUnits: !Ref 'WriteCapacityUnits'
  TzeroBusinessRulesTable:
    Type: AWS::DynamoDB::Table
    Properties:
      KeySchema:
      - AttributeName: ruleName
        KeyType: HASH
      AttributeDefinitions:
      - AttributeName: ruleName
        AttributeType: S
      TableName: !Sub ${EnvName}_TzeroBusinessRulesTable
      ProvisionedThroughput:
        ReadCapacityUnits: !Ref 'ReadCapacityUnits'
        WriteCapacityUnits: !Ref 'WriteCapacityUnits'
# ********** DynamoDB Resource creation- End**************

# ********** Tzero Lambda Function Resource- Start**************
# Lambda Function IAM Role Creation
  TzeroLambdaRole:
    Type: AWS::IAM::Role
    Properties:
      RoleName:
        Fn::Sub: TzeroLambdaRole
      AssumeRolePolicyDocument:
        Statement:
          - Action:
            - sts:AssumeRole
            Effect: Allow
            Principal:
              Service:
              - lambda.amazonaws.com
        Version: 2012-10-17
      ManagedPolicyArns:
        - arn:aws:iam::aws:policy/AWSLambdaExecute
        - arn:aws:iam::aws:policy/AmazonS3FullAccess
        - arn:aws:iam::aws:policy/AmazonDynamoDBFullAccess
        - arn:aws:iam::aws:policy/AmazonKinesisFullAccess
      Path: /
  TzeroRegistration:
    Type: "AWS::Serverless::Function"
    Properties:
      FunctionName: !Sub ${EnvName}_TzeroRegistration
      Description: "TzeroRegistration"
      Handler: "index.handler"
      Role:
        Fn::GetAtt:
          - TzeroLambdaRole
          - Arn    
      CodeUri: ./LambdaCode
      Runtime: "python3.7"
      Environment:
        Variables:
          ConsumerClientId: !Ref "TzeroConsumerAppClient"
          ProducerClientId: !Ref "TzeroProducerAppClient"
          ProducerPoolID: !Ref "TzeroProducerUserPool"
          TempPass: !Ref "LambdaTemporaryPassword"
          ConfigBucket: !Ref "LambdaConfigurationBucket"
          Configpath: !Ref "RegistrationConfigPath"
          Region: !Ref "Region"
      MemorySize: 128
      Timeout: 25
  TzeroConsumerProfile:
    Type: "AWS::Serverless::Function"
    Properties:
      Description: "TzeroConsumerProfile"
      FunctionName: !Sub ${EnvName}_TzeroConsumerProfile
      Handler: "index.handler"
      Role:
        Fn::GetAtt:
          - TzeroLambdaRole
          - Arn    
      CodeUri: ./LambdaCode
      Runtime: "python3.7"
      Environment:
        Variables:
          ConsumerTableName: !Ref "TzeroConsumerTable"
          Region: !Ref "Region"
      MemorySize: 128
      Timeout: 25
  TzeroConsumerChangePhoneNumber:
    Type: "AWS::Serverless::Function"
    Properties:
      Description: "TzeroConsumerChangePhoneNumber"
      FunctionName: !Sub ${EnvName}_TzeroConsumerChangePhoneNumber
      Handler: "index.handler"
      Role:
        Fn::GetAtt:
          - TzeroLambdaRole
          - Arn    
      CodeUri: ./LambdaCode
      Runtime: "python3.7"
      Environment:
        Variables:
          ClientId: !Ref "TzeroConsumerAppClient"
          UserPoolId: !Ref "TzeroConsumerUserPool"
          Region: !Ref "Region"
      MemorySize: 128
      Timeout: 25             
  TzeroConsumerAccess:
    Type: "AWS::Serverless::Function"
    Properties:
      Description: "TzeroConsumerAccess"
      FunctionName: !Sub ${EnvName}_TzeroConsumerAccess
      Handler: "index.handler"
      Role:
        Fn::GetAtt:
          - TzeroLambdaRole
          - Arn    
      CodeUri: ./LambdaCode
      Runtime: "python3.7"
      Environment:
        Variables:
          ConsumerClientID: !Ref "TzeroConsumerAppClient"
          ConsumerPasswordTable: !Ref "TzeroConsumerCredentialsTable"
          ConsumerTable: !Ref "TzeroConsumerTable"
          ConsumerUserPool: !Ref "TzeroConsumerUserPool"
          TempPass: !Ref "LambdaTemporaryPassword"
          Region: !Ref "Region"
  #          UpdateRewardsLambda: Lambda Name "ConsumerRewardManagement-Dev" needs to be created
      MemorySize: 128
      Timeout: 25      
  TzeroConsumerGetDetails:
    Type: "AWS::Serverless::Function"
    Properties:
      Description: "TzeroConsumerGetDetails"
      FunctionName: !Sub ${EnvName}_TzeroConsumerGetDetails
      Handler: "index.handler"
      Role:
        Fn::GetAtt:
          - TzeroLambdaRole
          - Arn    
      CodeUri: ./LambdaCode
      Runtime: "python3.7"
      Environment:
        Variables:
          CompressedConsumerMedias: !Ref "CompressedConsumerMediasCloudfrontDomainName"
          ConsumerInfoTable: !Ref "TzeroConsumerTable"
          ConsumerTransactionsTable: !Ref "TzeroConsumerTransactionsTable"
          ProducerAdsTable: !Ref "TzeroProducerAdvertTable"
          Region: !Ref "Region"
      MemorySize: 128
      Timeout: 25
  TzeroGetConsumerTransactions:
    Type: "AWS::Serverless::Function"
    Properties:
      Description: "TzeroGetConsumerTransactions"
      FunctionName: !Sub ${EnvName}_TzeroGetConsumerTransactions
      Handler: "index.handler"
      Role:
        Fn::GetAtt:
          - TzeroLambdaRole
          - Arn    
      CodeUri: ./LambdaCode
      Runtime: "python3.7"
      Environment:
        Variables:
          ConsumerInfoTable: !Ref "TzeroConsumerTable"
          ConsumerTransactionsTable: !Ref "TzeroConsumerTransactionsTable"
          Region: !Ref "Region"
      MemorySize: 128
      Timeout: 25
  TzeroCosumerGetImageAdvert:
    Type: "AWS::Serverless::Function"
    Properties:
      Description: "TzeroCosumerGetImageAdvert"
      FunctionName: !Sub ${EnvName}_TzeroCosumerGetImageAdvert
      Handler: "index.handler"
      Role:
        Fn::GetAtt:
          - TzeroLambdaRole
          - Arn    
      CodeUri: ./LambdaCode
      Runtime: "python3.7"
      Environment:
        Variables:
          CloudfrontDomainName: !Ref "TzeroConsumerTable"
          ConsumerInfoTable: !Ref "TzeroConsumerTransactionsTable"
          ProducerAdsTable: !Ref "TzeroProducerAdvertTable"
          Region: !Ref "Region"
      MemorySize: 128
      Timeout: 25
  TzeroProducerGetAdvertDetails:
    Type: "AWS::Serverless::Function"
    Properties:
      Description: "TzeroProducerGetAdvertDetails"
      FunctionName: !Sub ${EnvName}_TzeroProducerGetAdvertDetails
      Handler: "index.handler"
      Role:
        Fn::GetAtt:
          - TzeroLambdaRole
          - Arn    
      CodeUri: ./LambdaCode
      Runtime: "python3.7"
      Environment:
        Variables:
          ProducerAdvertTable: !Ref "TzeroProducerAdvertTable"
          ProducerInfoTable: !Ref "TzeroProducerTable"
          Region: !Ref "Region"
      MemorySize: 128
      Timeout: 25      
  TzeroDisplayAdvertToConsumers:
    Type: "AWS::Serverless::Function"
    Properties:
      Description: "TzeroDisplayAdvertToConsumers"
      FunctionName: !Sub ${EnvName}_TzeroDisplayAdvertToConsumers
      Handler: "index.handler"
      Role:
        Fn::GetAtt:
          - TzeroLambdaRole
          - Arn    
      CodeUri: ./LambdaCode
      Runtime: "python3.7"
      Environment:
        Variables:
          CloudfrontDomainName: !Ref "TzeroProducerAdvertTable"
          ConsumerTable: !Ref "TzeroConsumerTable"
          ProducerAdvertTable: !Ref "TzeroProducerAdvertTable"
          ProducerTable: !Ref "TzeroProducerTable"
          Region: !Ref "Region"
      MemorySize: 128
      Timeout: 25      
  TzeroProducerAccountAdministration:
    Type: "AWS::Serverless::Function"
    Properties:
      Description: "TzeroProducerAccountAdministration"
      FunctionName: !Sub ${EnvName}_TzeroProducerAccountAdministration
      Handler: "index.handler"
      Role:
        Fn::GetAtt:
          - TzeroLambdaRole
          - Arn 
      CodeUri: ./LambdaCode
      Runtime: "python3.7"
      Environment:
        Variables:
          ClientId: !Ref "TzeroProducerAppClient"
          UserPoolId: !Ref "TzeroProducerUserPool"
          ProducerTable: !Ref "TzeroProducerTable"
          Region: !Ref "Region"
      MemorySize: 128
      Timeout: 25      
  TzeroProducerMarketPlace:
    Type: "AWS::Serverless::Function"
    Properties:
      Description: "TzeroProducerMarketPlace"
      FunctionName: !Sub ${EnvName}_TzeroProducerMarketPlace
      Handler: "index.handler"
      Role:
        Fn::GetAtt:
          - TzeroLambdaRole
          - Arn 
      CodeUri: ./LambdaCode
      Runtime: "python3.7"
      Environment:
        Variables:
          FilePath: !Ref "ProducerMarketPlaceFilePath"
          ImageUploadUrlExpiry: !Ref "ProducerMarketPlaceImageUploadUrlExpiry"
          IndustryTagsPath: !Ref "ProducerMarketPlaceIndustryTagsPath"
          ProducerAdvertTable: !Ref "TzeroProducerAdvertTable"
          ProducerGlobalTagsTable: !Ref "TzeroProducerIndustryTagsTable"
          ProducerInfoTable: !Ref "TzeroProducerTable"
          ProducerMediaFiles: !Ref "ProducerMarketPlaceMediaFilesBucket"
          ProducerSupportTicketTable: !Ref "TzeroProducerSupportTicketTable"
          ThumbNailAppend: !Ref "ProducerMarketPlaceThumbNailAppend"
          Region: !Ref "Region"
      MemorySize: 128
      Timeout: 25
  TzeroConsumerMarketPlace:
    Type: "AWS::Serverless::Function"
    Properties:
      Description: "TzeroConsumerMarketPlace"
      FunctionName: !Sub ${EnvName}_TzeroConsumerMarketPlace
      Handler: "index.handler"
      Role:
        Fn::GetAtt:
          - TzeroLambdaRole
          - Arn 
      CodeUri: ./LambdaCode
      Runtime: "python3.7"
      Environment:
        Variables:
          ConsumerTableName: !Ref "TzeroConsumerTable"
          IndustryTagsPath: !Ref "ProducerMarketPlaceIndustryTagsPath"
          ProducerMediaFiles: !Ref "ProducerMarketPlaceMediaFilesBucket"
          ProducerTableName: !Ref "TzeroProducerTable"
          Region: !Ref "Region"
      MemorySize: 128
      Timeout: 25
  TzeroConsumerReportContent:
    Type: "AWS::Serverless::Function"
    Properties:
      Description: "TzeroConsumerReportContent"
      FunctionName: !Sub ${EnvName}_TzeroConsumerReportContent
      Handler: "index.handler"
      Role:
        Fn::GetAtt:
          - TzeroLambdaRole
          - Arn 
      CodeUri: ./LambdaCode
      Runtime: "python3.7"
      Environment:
        Variables:
          ProducerTableName: !Ref "TzeroProducerTable"
          ReceiverEmailAddress: !Ref "ConsumerReportContentReceiverEmailAddress"
          ReportingThreshold: !Ref "ConsumerReportContentReportingThreshold"
          SenderEmailAddress: !Ref "ConsumerReportContentSenderEmailAddress"
          Region: !Ref "Region"
      MemorySize: 128
      Timeout: 25
  TzeroProducerSurveyManagement:
    Type: "AWS::Serverless::Function"
    Properties:
      Description: "TzeroProducerSurveyManagement"
      FunctionName: !Sub ${EnvName}_TzeroProducerSurveyManagement
      Handler: "index.handler"
      Role:
        Fn::GetAtt:
          - TzeroLambdaRole
          - Arn 
      CodeUri: ./LambdaCode
      Runtime: "python3.7"
      Environment:
        Variables:
          ProducerTable: !Ref "TzeroProducerTable"
          SurveyTable: !Ref TzeroSurveyTable
          Region: !Ref "Region"
      MemorySize: 128
      Timeout: 25      
  TzeroConsumerAdvertViewsLikesUpdate:
    Type: "AWS::Serverless::Function"
    Properties:
      Description: "TzeroConsumerAdvertViewsLikesUpdate"
      FunctionName: !Sub ${EnvName}_TzeroConsumerAdvertViewsLikesUpdate
      Handler: "index.handler"
      Role:
        Fn::GetAtt:
          - TzeroLambdaRole
          - Arn 
      CodeUri: ./LambdaCode
      Runtime: "python3.7"
      Environment:
        Variables:
          ConsumerInfoTable: !Ref "TzeroConsumerTable"
          ProducerAdsTable: !Ref "TzeroProducerAdvertTable"
          Region: !Ref "Region"
      MemorySize: 128
      Timeout: 25      
  TzeroConsumerProfileUpdate:
    Type: "AWS::Serverless::Function"
    Properties:
      Description: "TzeroConsumerProfileUpdate"
      FunctionName: !Sub ${EnvName}_TzeroConsumerProfileUpdate
      Handler: "index.handler"
      Role:
        Fn::GetAtt:
          - TzeroLambdaRole
          - Arn 
      CodeUri: ./LambdaCode
      Runtime: "python3.7"
      Environment:
        Variables:
          AssumeRoleArn: !GetAtt TzeroLambdaRole.Arn
          AssumeRoleExpiry: 1000
          BusinessRulesTable: !Ref "TzeroBusinessRulesTable"
          ConsumerInfoTable: !Ref "TzeroConsumerTable"
          ConsumerPredefinedMediaPath: Consumer/Media/predefined-business-rules/
          ConsumerTransactionsTable: !Ref "TzeroConsumerTransactionsTable"
          FilePath: Producer/Media/
          ProducerAdsTable: !Ref "TzeroProducerAdvertTable"
          ProducerInfoTable: !Ref "TzeroProducerTable"
          ProducerMediaBucket: "tzero-telkom-backend-dev"
          Region: !Ref "Region"
      MemorySize: 128
      Timeout: 25
  ServerlessRepoApiLambdaGetOneDynGetOneLambda:
    Type: "AWS::Serverless::Function"
    Properties:
      Description: "ServerlessRepoApiLambdaGetOneDynGetOneLambda"
      FunctionName: !Sub ${EnvName}_ServerlessRepoApiLambdaGetOneDynGetOneLambda
      Handler: "index.handler"
      Role:
        Fn::GetAtt:
          - TzeroLambdaRole
          - Arn 
      CodeUri: ./LambdaCode
      Runtime: "python3.7"
      Environment:
        Variables:
          CORS_ORIGIN: !GetAtt TzeroLambdaRole.Arn
          IS_CORS: "IsCorsDefined"
          TABLE_NAME: !Ref "TzeroProducerTable"
          Region: !Ref "Region"
      MemorySize: 128
      Timeout: 25
  ServerlessRepoApiLambdaUpdateDynaUpdateLambda:
    Type: "AWS::Serverless::Function"
    Properties:
      Description: "ServerlessRepoApiLambdaUpdateDynaUpdateLambda"
      FunctionName: !Sub ${EnvName}_ServerlessRepoApiLambdaUpdateDynaUpdateLambda
      Handler: "index.handler"
      Role:
        Fn::GetAtt:
          - TzeroLambdaRole
          - Arn 
      CodeUri: ./LambdaCode
      Runtime: "python3.7"
      Environment:
        Variables:
          CORS_ORIGIN: !GetAtt TzeroLambdaRole.Arn
          IS_CORS: "IsCorsDefined"
          TABLE_NAME: !Ref "TzeroProducerTable"
          Region: !Ref "Region"
      MemorySize: 128
      Timeout: 25
#********** Tzero Lambda Function Resource- End**************

#********** API Gateway Resources creation- Start**************
  TzeroRestApi:
    Type: "AWS::ApiGateway::RestApi"
    Properties:
      Description: "Tzero Rest Api"
      EndpointConfiguration:
        Types:
          - REGIONAL
      Name: !Sub ${EnvName}_TzeroRestApi"
# ************ API ROOT METHOD- START**************
  RootGetMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'GET,POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
          - StatusCode: 200
            ResponseModels:
              application/json: 'Empty'
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: true
              method.response.header.Access-Control-Allow-Methods: true
              method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !GetAtt
          - TzeroRestApi
          - RootResourceId
      HttpMethod: GET
      AuthorizationType: NONE
  RootPostMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: POST
      AuthorizationType: NONE
      Integration:
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Origin: "'*'"
        IntegrationHttpMethod: POST
        Type: AWS
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroRegistration.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !GetAtt
        - TzeroRestApi
        - RootResourceId        
  RootMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !GetAtt
        - TzeroRestApi
        - RootResourceId
      HttpMethod: OPTIONS
      AuthorizationType: NONE
          
# ************ API ROOT METHOD- END**************
# ************ ConfirmConsumerRegistration Resource- Start********
  ConfirmConsumerRegistration:
     Type: "AWS::ApiGateway::Resource"
     Properties:
       ParentId:
         Fn::GetAtt:
           - "TzeroRestApi"
           - "RootResourceId"
       PathPart: ConfirmConsumerRegistration
       RestApiId:
         Ref: "TzeroRestApi"
  ConfirmConsumerRegistrationMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ConfirmConsumerRegistration
      HttpMethod: OPTIONS
      AuthorizationType: NONE
# ************ ConfirmConsumerRegistration Resource- End********

# ************ Consumer resource- Start********************
  Consumer:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId:
        Fn::GetAtt:
          - "TzeroRestApi"
          - "RootResourceId"
      PathPart: Consumer
      RestApiId:
        Ref: "TzeroRestApi"
  ConsumerMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref Consumer
      HttpMethod: OPTIONS
      AuthorizationType: NONE         
  ConsumerPhoneNumber:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId: !Ref Consumer
      PathPart: "{phoneNumber}"
      RestApiId:
        Ref: "TzeroRestApi"      
  ConsumerPhoneNumberGetMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: GET
      AuthorizationType: NONE
      Integration:
        IntegrationHttpMethod: GET
        Type: AWS_PROXY
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroConsumerProfile.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ConsumerPhoneNumber
  ConsumerPhoneNumberMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ConsumerPhoneNumber
      HttpMethod: OPTIONS
      AuthorizationType: NONE
  ConsumerPhoneNumberPatchMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: PATCH
      AuthorizationType: NONE
      Integration:
        IntegrationHttpMethod: PATCH
        Type: AWS_PROXY
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroConsumerProfile.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ConsumerPhoneNumber   
  ConsumerChangePhoneNumber:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId: !Ref ConsumerPhoneNumber
      PathPart: "ChangePhoneNumber"
      RestApiId:
        Ref: "TzeroRestApi" 
  ConsumerChangePhoneNumberMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ConsumerChangePhoneNumber
      HttpMethod: OPTIONS
      AuthorizationType: NONE
  ConsumerChangePhoneNumberPostMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: POST
      AuthorizationType: NONE
      Integration:
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Origin: "'*'"
        IntegrationHttpMethod: POST
        Type: AWS
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroConsumerChangePhoneNumber.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ConsumerChangePhoneNumber
# ************ Consumer resource- End********************

# ************ ConsumerLogin resource- Start*************
  ConsumerLogin:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId:
        Fn::GetAtt:
          - "TzeroRestApi"
          - "RootResourceId"
      PathPart: ConsumerLogin
      RestApiId:
        Ref: "TzeroRestApi"
  ConsumerLoginMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ConsumerLogin
      HttpMethod: OPTIONS
      AuthorizationType: NONE
  ConsumerLoginPostMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: POST
      AuthorizationType: NONE
      Integration:
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Origin: "'*'"
        IntegrationHttpMethod: POST
        Type: AWS
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroConsumerAccess.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ConsumerLogin     
# ************ ConsumerLogin resource- End*************
 
# ************ ConsumerRegistration resource- Start****
  ConsumerRegistration:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId:
        Fn::GetAtt:
          - "TzeroRestApi"
          - "RootResourceId"
      PathPart: ConsumerRegistration
      RestApiId:
        Ref: "TzeroRestApi"
  ConsumerRegistrationMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ConsumerRegistration
      HttpMethod: OPTIONS
      AuthorizationType: NONE
# ************ ConsumerRegistration resource- End*************
 
# ************ ConsumerResetPassword resource- Start**********
  ConsumerResetPassword:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId:
        Fn::GetAtt:
          - "TzeroRestApi"
          - "RootResourceId"
      PathPart: ConsumerResetPassword
      RestApiId:
        Ref: "TzeroRestApi"
  ConsumerResetPasswordMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ConsumerResetPassword
      HttpMethod: OPTIONS
      AuthorizationType: NONE
  ConsumerResetPasswordPostMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: POST
      AuthorizationType: NONE
      Integration:
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Origin: "'*'"
        IntegrationHttpMethod: POST
        Type: AWS
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroConsumerAccess.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ConsumerResetPassword 
# ************ ConsumerResetPassword resource- End**********

# ************ ConsumerSetPassword resource- Start**********
  ConsumerSetPassword:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId:
        Fn::GetAtt:
          - "TzeroRestApi"
          - "RootResourceId"
      PathPart: ConsumerSetPassword
      RestApiId:
        Ref: "TzeroRestApi"
  ConsumerSetPasswordMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ConsumerSetPassword
      HttpMethod: OPTIONS
      AuthorizationType: NONE
  ConsumerSetPasswordPostMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: POST
      AuthorizationType: NONE
      Integration:
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Origin: "'*'"
        IntegrationHttpMethod: POST
        Type: AWS
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroConsumerAccess.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ConsumerSetPassword 
# ************ ConsumerSetPassword resource- End**********

# ************getconsumerdetail resource- Start**********
  getconsumerdetail:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId:
        Fn::GetAtt:
          - "TzeroRestApi"
          - "RootResourceId"
      PathPart: getconsumerdetail
      RestApiId:
        Ref: "TzeroRestApi"
  getconsumerdetailMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref getconsumerdetail
      HttpMethod: OPTIONS
      AuthorizationType: NONE
  getconsumerdetailGetMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: GET
      AuthorizationType: NONE
      Integration:
        IntegrationHttpMethod: GET
        Type: AWS_PROXY
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroConsumerGetDetails.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref getconsumerdetail
# ************getconsumerdetail resource- End************

# ************getconsumerdetails resource- Start**********
  getconsumerdetails:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId:
        Fn::GetAtt:
          - "TzeroRestApi"
          - "RootResourceId"
      PathPart: getconsumerdetails
      RestApiId:
        Ref: "TzeroRestApi"
  getconsumerdetailsMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref getconsumerdetails
      HttpMethod: OPTIONS
      AuthorizationType: NONE
  getconsumerdetailsGetMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: GET
      AuthorizationType: NONE
      Integration:
        IntegrationHttpMethod: GET
        Type: AWS_PROXY
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroConsumerGetDetails.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref getconsumerdetails
# ************getconsumerdetails resource- End************

# ************getconsumertransactions resource- Start******
  getconsumertransactions:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId:
        Fn::GetAtt:
          - "TzeroRestApi"
          - "RootResourceId"
      PathPart: getconsumertransactions
      RestApiId:
        Ref: "TzeroRestApi"
  getconsumertransactionsMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref getconsumertransactions
      HttpMethod: OPTIONS
      AuthorizationType: NONE
  getconsumertransactionsPostMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: POST
      AuthorizationType: NONE
      Integration:
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Origin: "'*'"
        IntegrationHttpMethod: POST
        Type: AWS
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroGetConsumerTransactions.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref getconsumertransactions
# ************getconsumertransactions resource- End********

# ************getimageadvert resource- Start********
  getimageadvert:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId:
        Fn::GetAtt:
          - "TzeroRestApi"
          - "RootResourceId"
      PathPart: getimageadvert
      RestApiId:
        Ref: "TzeroRestApi"
  getimageadvertMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref getimageadvert
      HttpMethod: OPTIONS
      AuthorizationType: NONE
  getimageadvertGetMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: GET
      AuthorizationType: NONE
      Integration:
        IntegrationHttpMethod: GET
        Type: AWS_PROXY
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroCosumerGetImageAdvert.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref getimageadvert
# ************getimageadvert resource- End********

# ************getproduceradvertdetails resource- Start********
  getproduceradvertdetails:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId:
        Fn::GetAtt:
          - "TzeroRestApi"
          - "RootResourceId"
      PathPart: getproduceradvertdetails
      RestApiId:
        Ref: "TzeroRestApi"
  getproduceradvertdetailsMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref getproduceradvertdetails
      HttpMethod: OPTIONS
      AuthorizationType: NONE
  getproduceradvertdetailsGetMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: GET
      AuthorizationType: NONE
      Integration:
        IntegrationHttpMethod: GET
        Type: AWS_PROXY
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroProducerGetAdvertDetails.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref getproduceradvertdetails
# ************getproduceradvertdetails resource- End********

# ************loadadverttoconsume resource- Start********
  loadadverttoconsume:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId:
        Fn::GetAtt:
          - "TzeroRestApi"
          - "RootResourceId"
      PathPart: loadadverttoconsume
      RestApiId:
        Ref: "TzeroRestApi"
  loadadverttoconsumeMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref loadadverttoconsume
      HttpMethod: OPTIONS
      AuthorizationType: NONE
  loadadverttoconsumePostMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: POST
      AuthorizationType: NONE
      Integration:
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Origin: "'*'"
        IntegrationHttpMethod: POST
        Type: AWS
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroDisplayAdvertToConsumers.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref loadadverttoconsume
# ************loadadverttoconsume resource- End********

# ************ProducerLogin resource- Start*******
  ProducerLogin:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId:
        Fn::GetAtt:
          - "TzeroRestApi"
          - "RootResourceId"
      PathPart: ProducerLogin
      RestApiId:
        Ref: "TzeroRestApi"
  ProducerLoginMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ProducerLogin
      HttpMethod: OPTIONS
      AuthorizationType: NONE
  ProducerLoginPostMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: POST
      AuthorizationType: NONE
      Integration:
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Origin: "'*'"
        IntegrationHttpMethod: POST
        Type: AWS
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroRegistration.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ProducerLogin
# ************ProducerLogin resource- End********

# ************producermarketplace resource- Start********
  producermarketplace:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId:
        Fn::GetAtt:
          - "TzeroRestApi"
          - "RootResourceId"
      PathPart: producermarketplace
      RestApiId:
        Ref: "TzeroRestApi"
  producermarketplaceMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref producermarketplace
      HttpMethod: OPTIONS
      AuthorizationType: NONE
  producermarketplacePostMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: POST
      AuthorizationType: NONE
      Integration:
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Origin: "'*'"
        IntegrationHttpMethod: POST
        Type: AWS
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroProducerMarketPlace.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref producermarketplace
# ************producermarketplace resource- End********

# ************ProducerResetPassword resource- Start********
  ProducerResetPassword:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId:
        Fn::GetAtt:
          - "TzeroRestApi"
          - "RootResourceId"
      PathPart: ProducerResetPassword
      RestApiId:
        Ref: "TzeroRestApi"
  ProducerResetPasswordMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ProducerResetPassword
      HttpMethod: OPTIONS
      AuthorizationType: NONE
  ProducerResetPasswordPostMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: POST
      AuthorizationType: NONE
      Integration:
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Origin: "'*'"
        IntegrationHttpMethod: POST
        Type: AWS
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroRegistration.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ProducerResetPassword
# ************ProducerResetPassword resource- End********

# ************ProducerRegistration resource- Start********
  ProducerRegistration:
     Type: "AWS::ApiGateway::Resource"
     Properties:
       ParentId:
         Fn::GetAtt:
           - "TzeroRestApi"
           - "RootResourceId"
       PathPart: ProducerRegistration
       RestApiId:
         Ref: "TzeroRestApi"
  ProducerRegistrationMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ProducerRegistration
      HttpMethod: OPTIONS
      AuthorizationType: NONE
# ************ProducerRegistration resource- End********

# ************producerupdatesurvey resource- Start********
  producerupdatesurvey:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId:
        Fn::GetAtt:
          - "TzeroRestApi"
          - "RootResourceId"
      PathPart: producerupdatesurvey
      RestApiId:
        Ref: "TzeroRestApi"
  producerupdatesurveyMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref producerupdatesurvey
      HttpMethod: OPTIONS
      AuthorizationType: NONE
  producerupdatesurveyPostMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: POST
      AuthorizationType: NONE
      Integration:
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Origin: "'*'"
        IntegrationHttpMethod: POST
        Type: AWS
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroProducerSurveyManagement.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref producerupdatesurvey
# ************producerupdatesurvey resource- End********

# ************updateadvertviews resource- Start********
  updateadvertviews:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId:
        Fn::GetAtt:
          - "TzeroRestApi"
          - "RootResourceId"
      PathPart: updateadvertviews
      RestApiId:
        Ref: "TzeroRestApi"
  updateadvertviewsMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref updateadvertviews
      HttpMethod: OPTIONS
      AuthorizationType: NONE
  updateadvertviewsPostMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: POST
      AuthorizationType: NONE
      Integration:
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Origin: "'*'"
        IntegrationHttpMethod: POST
        Type: AWS
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroConsumerAdvertViewsLikesUpdate.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref updateadvertviews
# ************updateadvertviews resource- End********

# ************updateconsumerprofile resource- Start********
  updateconsumerprofile:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId:
        Fn::GetAtt:
          - "TzeroRestApi"
          - "RootResourceId"
      PathPart: updateconsumerprofile
      RestApiId:
        Ref: "TzeroRestApi"
  updateconsumerprofileMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref updateconsumerprofile
      HttpMethod: OPTIONS
      AuthorizationType: NONE
  updateconsumerprofilePostMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: POST
      AuthorizationType: NONE
      Integration:
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Origin: "'*'"
        IntegrationHttpMethod: POST
        Type: AWS
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroConsumerProfileUpdate.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref updateconsumerprofile
# ************updateconsumerprofile resource- End********

# ************producerSurveyManagement resource- start********
  producerSurveyManagement:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId:
        Fn::GetAtt:
          - "TzeroRestApi"
          - "RootResourceId"
      PathPart: producerSurveyManagement
      RestApiId:
        Ref: "TzeroRestApi"
  producerSurveyManagementMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref producerSurveyManagement
      HttpMethod: OPTIONS
      AuthorizationType: NONE
  producerSurveyManagementAnyMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: ANY
      AuthorizationType: NONE
      Integration:
        IntegrationHttpMethod: ANY
        Type: AWS_PROXY
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroProducerSurveyManagement.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref producerSurveyManagement
# ************producerSurveyManagement resource- End********

# ************ Producers resource- Start********************
  Producers:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId:
        Fn::GetAtt:
          - "TzeroRestApi"
          - "RootResourceId"
      PathPart: Producers
      RestApiId:
        Ref: "TzeroRestApi"
  ProducersGetMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: GET
      AuthorizationType: NONE
      Integration:
        IntegrationHttpMethod: GET
        Type: AWS_PROXY
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroConsumerMarketPlace.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref Producers
  ProducersMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref Producers
      HttpMethod: OPTIONS
      AuthorizationType: NONE         
  ProducersproducerId:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId: !Ref Producers
      PathPart: "{producerId}"
      RestApiId:
        Ref: "TzeroRestApi"      
  ProducersproducerIdGetMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: GET
      AuthorizationType: NONE
      Integration:
        IntegrationHttpMethod: GET
        Type: AWS_PROXY
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "ServerlessRepoApiLambdaGetOneDynGetOneLambda.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ProducersproducerId
  ProducersproducerIdMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ProducersproducerId
      HttpMethod: OPTIONS
      AuthorizationType: NONE
  ProducersproducerIdPutMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: PUT
      AuthorizationType: NONE
      Integration:
        IntegrationHttpMethod: PUT
        Type: AWS_PROXY
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "ServerlessRepoApiLambdaUpdateDynaUpdateLambda.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ProducersproducerId   
  ProducersReportedContent:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId: !Ref ProducersproducerId
      PathPart: "ReportedContent"
      RestApiId:
        Ref: "TzeroRestApi" 
  ProducersReportedContentMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ProducersReportedContent
      HttpMethod: OPTIONS
      AuthorizationType: NONE
  ProducersReportedContentPostMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: POST
      AuthorizationType: NONE
      Integration:
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Origin: "'*'"
        IntegrationHttpMethod: POST
        Type: AWS
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroConsumerReportContent.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ProducersReportedContent
# ************ Producers resource- End********************

# ************ ProducerAccount resource- Start********************
  ProducerAccount:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId:
        Fn::GetAtt:
          - "TzeroRestApi"
          - "RootResourceId"
      PathPart: ProducerAccount
      RestApiId:
        Ref: "TzeroRestApi"
  ProducerAccountMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ProducerAccount
      HttpMethod: OPTIONS
      AuthorizationType: NONE         
  ProducerAccountusername:
    Type: "AWS::ApiGateway::Resource"
    Properties:
      ParentId: !Ref ProducerAccount
      PathPart: "{username}"
      RestApiId:
        Ref: "TzeroRestApi"      
  ProducerAccountusernameGetMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: GET
      AuthorizationType: NONE
      Integration:
        IntegrationHttpMethod: GET
        Type: AWS_PROXY
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroProducerAccountAdministration.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ProducerAccountusername
  ProducerAccountusernameMockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      Integration:
        Type: MOCK
        IntegrationResponses:
          - ResponseTemplates:
              application/json: ''
            StatusCode: 200
            ResponseParameters:
              method.response.header.Access-Control-Allow-Headers: "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'"
              method.response.header.Access-Control-Allow-Methods: "'POST,OPTIONS'"
              method.response.header.Access-Control-Allow-Origin: "'*'"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
          ResponseParameters:
            method.response.header.Access-Control-Allow-Headers: true
            method.response.header.Access-Control-Allow-Methods: true
            method.response.header.Access-Control-Allow-Origin: true
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ProducerAccountusername
      HttpMethod: OPTIONS
      AuthorizationType: NONE
  ProducerAccountusernamePatchMethod:
    Type: "AWS::ApiGateway::Method"
    Properties:
      HttpMethod: PATCH
      AuthorizationType: NONE
      Integration:
        IntegrationHttpMethod: PATCH
        Type: AWS_PROXY
        Uri: !Sub
          - "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"
          - lambdaArn: !GetAtt "TzeroProducerAccountAdministration.Arn"
      MethodResponses:
        - StatusCode: 200
          ResponseModels:
            application/json: 'Empty'
      RestApiId: !Ref TzeroRestApi
      ResourceId: !Ref ProducerAccountusername  
      
# ************ ProducerAccount resource- End********************

# ********** Tzero Lambda Function Output - Start**************
Outputs:
  TzeroProducerUserPoolId:
    Value: !Ref TzeroProducerUserPool
    Export:
      Name: "TzeroProducerUserPoolId"
  TzeroConsumerUserPoolId:
    Value: !Ref TzeroConsumerUserPool
  TzeroProducerAppClientId:
    Value: !Ref TzeroProducerAppClient
  TzeroConsumerAppClientId:
    Value: !Ref TzeroConsumerAppClient
  TzeroProducerTableName:
    Value: !Ref 'TzeroProducerTable'
    Export:
      Name: "TzeroProducerTable"
  TzeroProducerAdvertTableName:
    Value: !Ref 'TzeroProducerAdvertTable'
  TzeroProducerSupportTicketTableName:
    Value: !Ref 'TzeroProducerSupportTicketTable'
  TzeroProducerIndustryTagsTableName:
    Value: !Ref 'TzeroProducerIndustryTagsTable'
  TzeroConsumerTableName:
    Value: !Ref 'TzeroConsumerTable'
  TzeroConsumerTransactionsTableName:
    Value: !Ref 'TzeroConsumerTransactionsTable'
  TzeroConsumerCredentialsTableName:
    Value: !Ref 'TzeroConsumerCredentialsTable'
  TzeroConsumerExperiencePointsTableName:
    Value: !Ref 'TzeroConsumerExperiencePointsTable'
  TzeroSurveyTableName:
    Value: !Ref 'TzeroSurveyTable'
  TzeroBusinessRulesTableName:
    Value: !Ref 'TzeroBusinessRulesTable'
  TzeroRegistrationFunctionName:
    Value: !Ref TzeroRegistration
  TzeroRegistrationLambdaFunctionARN:
    Value:
      Fn::GetAtt:
        - TzeroRegistration
        - Arn
    Export:
      Name: "TzeroRegistrationLambdaFunctionARN"     
      

 # ********** Tzero Lambda Function Output- End**************
